(self.webpackJsonp__wix_thunderbolt_app = self.webpackJsonp__wix_thunderbolt_app || []).push([
    [5776], {
        53104: function(e, t, n) {
            "use strict";
            n.r(t), n.d(t, {
                MasterPageTpaPropsCacheSymbol: function() {
                    return o.lP
                },
                PinnedExternalIdStoreSymbol: function() {
                    return o.Aq
                },
                TpaContextMappingSymbol: function() {
                    return o.ex
                },
                TpaDataCapsuleSymbol: function() {
                    return o.yA
                },
                TpaHandlersManagerSymbol: function() {
                    return o.XA
                },
                TpaSectionSymbol: function() {
                    return o.B_
                },
                TpaSrcBuilderSymbol: function() {
                    return o.RN
                },
                TpaSrcUtilitySymbol: function() {
                    return o.NQ
                },
                name: function() {
                    return o.u2
                },
                site: function() {
                    return O
                }
            });
            var r = n(95793),
                o = n(20140),
                a = n(31191),
                i = n(43757),
                u = n(56405),
                c = n(61049),
                p = n(5096),
                l = n(58629),
                s = n(26513),
                d = n(55048),
                f = n(16684),
                g = n.n(f),
                m = n(29203),
                v = n(46466),
                I = (0, i.ff)([(0, i.t6)(c.R9, o.u2)], (function(e) {
                    return {
                        getQueryParams: function(t) {
                            var n = t.compId,
                                r = t.pageId,
                                o = t.tpaCompData,
                                i = t.options.extraQueryParams,
                                u = e.siteRevision,
                                c = e.editorOrSite,
                                p = e.deviceType,
                                l = e.locale,
                                s = e.tpaDebugParams,
                                d = e.timeZone,
                                f = e.regionalLanguage,
                                m = o.templateId,
                                v = o.width,
                                I = o.height,
                                y = o.isResponsive;
                            return (0, a.pi)((0, a.pi)({
                                pageId: r,
                                compId: m || n,
                                viewerCompId: n,
                                siteRevision: "" + u,
                                viewMode: c,
                                deviceType: p,
                                locale: l,
                                tz: d,
                                regionalLanguage: f,
                                width: !y && g().isNumber(v) ? "" + v : null,
                                height: !y && g().isNumber(I) ? "" + I : null
                            }, s), i)
                        }
                    }
                })),
                y = (0, i.ff)([], (function() {
                    return {
                        getQueryParams: function(e) {
                            return {
                                externalId: e.tpaCompData.externalId
                            }
                        }
                    }
                })),
                h = (0, i.ff)([(0, i.t6)(c.R9, o.u2), u.X], (function(e, t) {
                    var n = e.widgetsClientSpecMapData;
                    return {
                        getQueryParams: function(e) {
                            var r = e.tpaCompData,
                                o = e.options,
                                a = (n[r.widgetId] || {}).appDefinitionId || o.appDefinitionId || "";
                            return {
                                instance: t.getAppInstanceByAppDefId(a)
                            }
                        }
                    }
                })),
                P = (0, i.ff)([(0, i.t6)(c.R9, o.u2), p.ZQ], (function(e, t) {
                    return {
                        getQueryParams: function() {
                            var n, r = e.requestUrl,
                                o = e.extras,
                                a = new URL((null === (n = null == t ? void 0 : t.location) || void 0 === n ? void 0 : n.href) || r);
                            return {
                                currency: o.currency,
                                currentCurrency: a.searchParams.get("currency") || o.currency
                            }
                        }
                    }
                })),
                R = (0, i.ff)([l.s], (function(e) {
                    var t = e.viewerSessionId;
                    return {
                        getQueryParams: function() {
                            return {
                                vsi: t
                            }
                        }
                    }
                })),
                C = (0, i.ff)([m.e], (function(e) {
                    return {
                        getQueryParams: function() {
                            var t, n = e.getCurrentConsentPolicy();
                            return {
                                "consent-policy": (t = n).defaultPolicy && g().every(t.policy) || !e._getConsentPolicyHeader()["consent-policy"] ? void 0 : decodeURIComponent(e._getConsentPolicyHeader()["consent-policy"])
                            }
                        }
                    }
                })),
                w = (0, i.ff)([v.p], (function(e) {
                    return {
                        getQueryParams: function() {
                            return {
                                commonConfig: JSON.stringify(e.getCommonConfigForUrl())
                            }
                        }
                    }
                })),
                S = (0, i.ff)([s.jj], (function(e) {
                    return {
                        getQueryParams: function() {
                            var t, n, r = null === (n = null === (t = e.getCurrentRouteInfo()) || void 0 === t ? void 0 : t.dynamicRouteData) || void 0 === n ? void 0 : n.publicData;
                            return {
                                routerData: r ? JSON.stringify(r) : null
                            }
                        }
                    }
                })),
                D = (0, i.ff)([(0, i.t6)(c.R9, o.u2), d.QZ, p.ZQ], (function(e, t, n) {
                    return {
                        getQueryParams: function(r) {
                            var o, i = r.compId,
                                u = r.tpaCompData,
                                c = r.options,
                                p = e.widgetsClientSpecMapData,
                                l = e.appSectionParams,
                                s = e.isMobileView,
                                d = e.requestUrl,
                                f = e.viewMode,
                                g = e.externalBaseUrl,
                                m = {
                                    target: null,
                                    "section-url": null
                                };
                            if (u.widgetId) {
                                var v = p[u.widgetId],
                                    I = v.widgetUrl,
                                    y = v.mobileUrl,
                                    h = s && y || I,
                                    P = ((null === (o = t.get(i)) || void 0 === o ? void 0 : o.componentType) || "").toLowerCase().endsWith("section");
                                u.isSection && P && ("site" === f ? (m["section-url"] = g + "/" + c.tpaInnerRouteConfig.tpaPageUri + "/", m.target = "_top") : (m["section-url"] = h, m.target = "_self"))
                            }
                            return (0, a.pi)((0, a.pi)({}, function() {
                                var e;
                                if (n) {
                                    var t = new URL((null === (e = null == n ? void 0 : n.location) || void 0 === e ? void 0 : e.href) || d).searchParams.get("appSectionParams");
                                    return JSON.parse(decodeURIComponent(t || "{}")) || {}
                                }
                                return l
                            }()), m)
                        }
                    }
                })),
                T = (0, i.ff)([(0, i.t6)(c.R9, o.u2)], (function(e) {
                    var t = e.metaSiteId,
                        r = {},
                        o = function(e, t, n) {
                            return r[n]
                        },
                        i = function(e, n, o, a) {
                            return e.namespace = r[a], e.scope = t, e
                        },
                        u = g().once((function() {
                            return (0, a.mG)(void 0, void 0, void 0, (function() {
                                return (0, a.Jh)(this, (function(e) {
                                    switch (e.label) {
                                        case 0:
                                            return [4, n.e(7293).then(n.bind(n, 27293))];
                                        case 1:
                                            return (new(e.sent().FrameStorageListener)).start(o, i), [2]
                                    }
                                }))
                            }))
                        }));
                    return {
                        registerToDataCapsule: function(e, t) {
                            u(), r[e] = t
                        },
                        unregister: function(e) {
                            delete r[e]
                        }
                    }
                })),
                x = n(59032),
                b = (0, i.ff)([], (function() {
                    var e = {},
                        t = {};
                    return {
                        registerTpasForContext: function(t, n) {
                            var r = t.contextId,
                                o = t.pageId;
                            n.forEach((function(t) {
                                e[t] = {
                                    contextId: r,
                                    pageId: o
                                }
                            }))
                        },
                        getTpaComponentPageInfo: function(t) {
                            return e[t]
                        },
                        registerTpaTemplateId: function(e, n) {
                            t[e] = n
                        },
                        getTpaComponentIdFromTemplate: function(e) {
                            return t[e]
                        },
                        unregisterTpa: function(t) {
                            delete e[t]
                        }
                    }
                })),
                U = n(65070),
                Q = (0, i.ff)([(0, i.t6)(c.R9, o.u2), p.ZQ, (0, i.fi)(r.R)], (function(e, t, n) {
                    var r = e.widgetsClientSpecMapData,
                        o = e.externalBaseUrl,
                        i = e.requestUrl;
                    return {
                        buildSrc: function(e, u, c, p, l) {
                            void 0 === l && (l = {});
                            var s, d = r[c.widgetId] || {},
                                f = g().merge({
                                    tpaInnerRouteConfig: null,
                                    extraQueryParams: {},
                                    appDefinitionId: ""
                                }, l),
                                m = {
                                    compId: e,
                                    pageId: u,
                                    tpaCompData: c,
                                    options: f
                                },
                                v = g().assign.apply(g(), (0, a.ev)([{}], (0, a.CR)(n.map((function(e) {
                                    return e.getQueryParams(m)
                                }))))),
                                I = f.tpaInnerRouteConfig ? function(e, n) {
                                    var r, u = Boolean(n.tpaPageUri && !g().isNil(d.applicationId) && d.applicationId === n.tpaApplicationId),
                                        c = (0, a.CR)(((null == t ? void 0 : t.location.href) || i).replace(o, "").split("?"), 1)[0],
                                        p = (0, a.CR)(decodeURIComponent(c).split("?"), 2),
                                        l = p[0],
                                        s = p[1],
                                        f = u && (0, U._)(l, n.tpaPageUri);
                                    return f && (null === (r = d.appPage) || void 0 === r ? void 0 : r.defaultPage) && f.unshift(d.appPage.defaultPage), f ? function(e, t, n) {
                                        if (0 === e.length) return t;
                                        var r = e.join("/"),
                                            o = new URL(t);
                                        return o.pathname += "/" + r, n && new URLSearchParams(n).forEach((function(e, t) {
                                            return o.searchParams.append(t, e)
                                        })), o.href
                                    }(f, e, s) : e
                                }(p, f.tpaInnerRouteConfig) : p;
                            try {
                                s = new URL(I)
                            } catch (e) {
                                return ""
                            }
                            return g().entries(v).forEach((function(e) {
                                var t = (0, a.CR)(e, 2),
                                    n = t[0],
                                    r = t[1];
                                g().isNil(r) || s.searchParams.set(n, r)
                            })), s.href
                        }
                    }
                })),
                M = (0, i.ff)([], (function() {
                    var e = {},
                        t = {};
                    return {
                        registerTpaSection: function(n, r) {
                            e[n] = r, t[r.appDefinitionId] = n
                        },
                        unregisterTpaSection: function(n) {
                            var r = e[n],
                                o = null == r ? void 0 : r.appDefinitionId;
                            delete e[n], o && delete t[o]
                        },
                        getTpaSectionByAppDefinitionId: function(n) {
                            var r = t[n];
                            return e[r]
                        }
                    }
                })),
                _ = n(24263),
                A = n(97880),
                N = n(37793),
                E = function(e) {
                    if (e.data) try {
                        return JSON.parse(e.data)
                    } catch (e) {}
                    return {}
                },
                B = ["getWixUpgradeUrl", "stylesReady", "getViewModeInternal", "setHelpArticle"],
                J = (0, i.ff)([A.D, _._w, o.ex, d.QZ, (0, i.jt)(p.EE), (0, i.jt)(N.KO)], (function(e, t, n, r, i, u) {
                    var c = function(e) {
                        var n = e.contextId,
                            r = e.pageId;
                        return (0, a.mG)(void 0, void 0, Promise, (function() {
                            return (0, a.Jh)(this, (function(e) {
                                switch (e.label) {
                                    case 0:
                                        return [4, t(n, r)];
                                    case 1:
                                        return [2, e.sent().getAllImplementersOnPageOf(o.XA)[0]]
                                }
                            }))
                        }))
                    };
                    return {
                        appDidMount: function() {
                            e.addWindowMessageHandler({
                                canHandleEvent: function(e) {
                                    return !!(e.source && (t = E(e), t && ["TPA", "TPA2"].includes(t.intent)));
                                    var t
                                },
                                handleEvent: function(e) {
                                    return (0, a.mG)(this, void 0, void 0, (function() {
                                        var t, o, p, l, s, d, f, g, m;
                                        return (0, a.Jh)(this, (function(v) {
                                            switch (v.label) {
                                                case 0:
                                                    return t = E(e), o = t.type, p = t.callId, B.includes(o) ? [2] : (l = function(e) {
                                                        var t = e.compId;
                                                        if (t) {
                                                            var o = n.getTpaComponentPageInfo(t);
                                                            if (!o || !o.contextId) {
                                                                var a = r.getContextIdOfCompId(t);
                                                                if (a) return {
                                                                    contextId: a,
                                                                    pageId: a
                                                                }
                                                            }
                                                            return o
                                                        }
                                                    }(t), s = l && l.contextId ? l.contextId : null, d = n.getTpaComponentIdFromTemplate(t.compId), f = null != d ? d : t.compId, g = (0, a.pi)((0, a.pi)({}, t), {
                                                        compId: f
                                                    }), m = e.origin, u && u.tpa.addMessage({
                                                        message: g,
                                                        compId: f,
                                                        contextId: s,
                                                        origin: m
                                                    }), s ? [4, c(l)] : (console.error("TPA handler message caller does not belong to any page", {
                                                        type: o,
                                                        callId: p,
                                                        compId: f
                                                    }), [2]));
                                                case 1:
                                                    return v.sent().handleMessage({
                                                        source: e.source,
                                                        origin: m,
                                                        message: g
                                                    }).catch((function(e) {
                                                        console.error("HandleTpaMessageError", o, s, f, e), null == i || i.captureError(e, {
                                                            tags: {
                                                                feature: "tpa",
                                                                handlerName: o
                                                            },
                                                            extra: {
                                                                handlerName: o,
                                                                compId: f
                                                            }
                                                        })
                                                    })), [2]
                                            }
                                        }))
                                    }))
                                }
                            })
                        }
                    }
                })),
                L = (0, i.ff)([d.xP, s.jj], (function(e, t) {
                    var n = {};
                    return {
                        cacheProps: function(t, r) {
                            var o = g().omitBy(r || e.get(t), g().isFunction);
                            n[t] = g().isEmpty(o) ? null : o
                        },
                        getCachedProps: function(e) {
                            var r, o, a, i, u = n[e];
                            if (u) return g().isEqual(null === (o = null === (r = t.getCurrentRouteInfo()) || void 0 === r ? void 0 : r.dynamicRouteData) || void 0 === o ? void 0 : o.publicData, null === (i = null === (a = t.getPreviousRouterInfo()) || void 0 === a ? void 0 : a.dynamicRouteData) || void 0 === i ? void 0 : i.publicData) || delete u.src, u
                        }
                    }
                })),
                O = function(e) {
                    ! function(e) {
                        e(o.lP).to(L), e(x.j.AppDidMountHandler).to(J), e(o.ex).to(b), e(o.RN).to(Q), e(o.B_).to(M), e(r.R).to(I), e(r.R).to(h), e(r.R).to(P), e(r.R).to(w), e(r.R).to(S), e(r.R).to(D)
                    }(e), e(r.R).to(C), e(r.R).to(y), e(r.R).to(R), e(o.yA).to(T)
                }
        }
    }
]);
//# sourceMappingURL=https://static.parastorage.com/services/wix-thunderbolt/dist/tpaCommons.622919d7.chunk.min.js.map